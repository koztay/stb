{% extends "__base.html" %}
{% load staticfiles %}
{% load get_thumbnail %}

<script>
    {% block jquery %}
        function setPrice() {
            var price = $(".variation_select option:selected").attr("data-price");

            var sale_price = $(".variation_select option:selected").attr("data-sale-price");
            if (sale_price != "" && sale_price != "None" && sale_price != null) {
                $("#price").html("<h3>" + sale_price + " <small class='og-price'>" + price + "</small></h3>");
            } else {
                $("#price").html(price);
            }
        }
        setPrice();

        $(".variation_select").change(function () {
            setPrice();
            // var img = $(".variation_select option:selected").attr("data-img")
            // $("img").attr("src", img);

        });

        // ajax add to cart
        $("#submit-btn").click(function (event) {
            event.preventDefault();
            var formData = $("#add-form").serialize();
            console.log(formData);
            $.ajax({
                type: "GET", // "POST"
                url: "{% url 'cart' %}",
                data: formData,
                success: function (data) {
                    showFlashMessage(data.flash_message);
                    updateCartItemCount();
                },
                error: function (response, error) {
                    // console.log(response)
                    // console.log(error)
                    $("#add-form").submit()
                }
            });

            // $("#add-form").submit()

        });
    {% endblock %}
</script>

{% block content %}

<!-- catg header banner section -->
<section id="aa-catg-head-banner">
    <img src='{% static "img/fashion/fashion-header-bg-8.jpg" %}' alt="fashion img">
    <div class="aa-catg-head-banner-area">
        <div class="container">
            <div class="aa-catg-head-banner-content">
                <h2>{{ object.title }}</h2>
                <ol class="breadcrumb">
                    <li><a href="index.html">Home</a></li>
                    <li><a href="#">Product</a></li>
                    <li class="active">{{ object.title }}</li>
                </ol>
            </div>
        </div>
    </div>
</section>
<!-- / catg header banner section -->

<!-- product category -->
<section id="aa-product-details">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div class="aa-product-details-area">
                    <div class="aa-product-details-content">
                        <div class="row">
                            <!-- Modal view slider -->
                            <div class="col-md-5 col-sm-5 col-xs-12">
                                <div class="aa-product-view-slider">
                                    <div id="demo-1" class="simpleLens-gallery-container">
                                        <div class="simpleLens-container">
                                            <div class="simpleLens-big-image-container"><a
                                                    data-lens-image="img/view-slider/large/polo-shirt-1.png"
                                                    class="simpleLens-lens-image"><img
                                                    src="img/view-slider/medium/polo-shirt-1.png"
                                                    class="simpleLens-big-image"></a></div>
                                        </div>
                                        <div class="simpleLens-thumbnails-container">
                                            <a data-big-image="img/view-slider/medium/polo-shirt-1.png"
                                               data-lens-image="img/view-slider/large/polo-shirt-1.png"
                                               class="simpleLens-thumbnail-wrapper" href="#">
                                                <img src="img/view-slider/thumbnail/polo-shirt-1.png">
                                            </a>
                                            <a data-big-image="img/view-slider/medium/polo-shirt-3.png"
                                               data-lens-image="img/view-slider/large/polo-shirt-3.png"
                                               class="simpleLens-thumbnail-wrapper" href="#">
                                                <img src="img/view-slider/thumbnail/polo-shirt-3.png">
                                            </a>
                                            <a data-big-image="img/view-slider/medium/polo-shirt-4.png"
                                               data-lens-image="img/view-slider/large/polo-shirt-4.png"
                                               class="simpleLens-thumbnail-wrapper" href="#">
                                                <img src="img/view-slider/thumbnail/polo-shirt-4.png">
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Modal view content -->
                            <div class="col-md-7 col-sm-7 col-xs-12">
                                <div class="aa-product-view-content">
                                    <h3>{{ object.title }}</h3>
                                    <div class="aa-price-block">
                                        <span class="aa-product-view-price" id='price'>
                                            {{ object.variation_set.first.price }} ,-â‚º
                                        </span>
                                        <p class="aa-product-avilability">Stok Durumu: <span>10+</span></p>
                                    </div>
                                    <p>{{ object.description|truncatechars:150 }}</p>
                                    <h4>Size</h4>
                                    <div class="aa-prod-view-size">
                                        <a href="#">S</a>
                                        <a href="#">M</a>
                                        <a href="#">L</a>
                                        <a href="#">XL</a>
                                    </div>
                                    <h4>Color</h4>
                                    <div class="aa-color-tag">
                                        <a href="#" class="aa-color-green"></a>
                                        <a href="#" class="aa-color-yellow"></a>
                                        <a href="#" class="aa-color-pink"></a>
                                        <a href="#" class="aa-color-black"></a>
                                        <a href="#" class="aa-color-white"></a>
                                    </div>
                                    <form id='add-form' method='GET' action="{% url 'cart' %}">
                                        <p id='jquery-message' class='lead'>

                                        </p>
                                        {% if object.variation_set.count > 1 %}
                                            <select name='item' class='form-control variation_select'>
                                                {% for vari_obj in object.variation_set.all %}
                                                    <!-- <option data-img="http://www.spirit1059.com/pics/Feeds/Articles/2015611/118317/Beach.jpg" data-price="{{ vari_obj.price }}" value="{{ vari_obj.id }}">{{ vari_obj }}</option> -->
                                                    <option data-sale-price="{{ vari_obj.sale_price }}" data-price="{{ vari_obj.price }}"
                                                            value="{{ vari_obj.id }}">{{ vari_obj }}</option>
                                                {% endfor %}
                                            </select>

                                        {% else %}
                                            <input type="hidden" name='item' value='{{ object.variation_set.first.id }}'/>
                                            <h3 id='price'>{% if object.variation_set.first.sale_price %}
                                                {{ object.variation_set.first.sale_price }}
                                                <small class='og-price'>{{ object.variation_set.first.price }}</small>
                                            {% else %}

                                                {{ object.variation_set.first.price }}
                                            {% endif %}
                                            </h3>


                                        {% endif %}
                                        <br/>
                                        <input class='form-control' type='number' name='qty' value='1'/>
                                        <br/>
                                        <input id='submit-btn' type='submit' value='Add to Cart' class='btn btn-default'/>
                                    </form>
                                    <div class="aa-prod-quantity">
                                        <form action="">
                                            <select id="" name="">
                                                <option selected="1" value="0">1</option>
                                                <option value="1">2</option>
                                                <option value="2">3</option>
                                                <option value="3">4</option>
                                                <option value="4">5</option>
                                                <option value="5">6</option>
                                            </select>
                                        </form>
                                        <p class="aa-prod-category">
                                            Category: <a href="#">Polo T-Shirt</a>
                                        </p>
                                    </div>
                                    <div class="aa-prod-view-bottom">
                                        <a class="aa-add-to-cart-btn" href="#">Add To Cart</a>
                                        <a class="aa-add-to-cart-btn" href="#">Wishlist</a>
                                        <a class="aa-add-to-cart-btn" href="#">Compare</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="aa-product-details-bottom">
                        <ul class="nav nav-tabs" id="myTab2">
                            <li><a href="#description" data-toggle="tab">Description</a></li>
                            <li><a href="#review" data-toggle="tab">Reviews</a></li>
                        </ul>

                        <!-- Tab panes -->
                        <div class="tab-content">
                            <div class="tab-pane fade in active" id="description">
                                <p>{{ object.description }}</p>
                            </div>
                            <div class="tab-pane fade " id="review">
                                <div class="aa-product-review-area">
                                    <h4>2 Reviews for T-Shirt</h4>
                                    <ul class="aa-review-nav">
                                        <li>
                                            <div class="media">
                                                <div class="media-left">
                                                    <a href="#">
                                                        <img class="media-object" src="img/testimonial-img-3.jpg"
                                                             alt="girl image">
                                                    </a>
                                                </div>
                                                <div class="media-body">
                                                    <h4 class="media-heading"><strong>Marla Jobs</strong> - <span>March 26, 2016</span>
                                                    </h4>
                                                    <div class="aa-product-rating">
                                                        <span class="fa fa-star"></span>
                                                        <span class="fa fa-star"></span>
                                                        <span class="fa fa-star"></span>
                                                        <span class="fa fa-star"></span>
                                                        <span class="fa fa-star-o"></span>
                                                    </div>
                                                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>
                                                </div>
                                            </div>
                                        </li>
                                        <li>
                                            <div class="media">
                                                <div class="media-left">
                                                    <a href="#">
                                                        <img class="media-object" src="img/testimonial-img-3.jpg"
                                                             alt="girl image">
                                                    </a>
                                                </div>
                                                <div class="media-body">
                                                    <h4 class="media-heading"><strong>Marla Jobs</strong> - <span>March 26, 2016</span>
                                                    </h4>
                                                    <div class="aa-product-rating">
                                                        <span class="fa fa-star"></span>
                                                        <span class="fa fa-star"></span>
                                                        <span class="fa fa-star"></span>
                                                        <span class="fa fa-star"></span>
                                                        <span class="fa fa-star-o"></span>
                                                    </div>
                                                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>
                                                </div>
                                            </div>
                                        </li>
                                    </ul>
                                    <h4>Add a review</h4>
                                    <div class="aa-your-rating">
                                        <p>Your Rating</p>
                                        <a href="#"><span class="fa fa-star-o"></span></a>
                                        <a href="#"><span class="fa fa-star-o"></span></a>
                                        <a href="#"><span class="fa fa-star-o"></span></a>
                                        <a href="#"><span class="fa fa-star-o"></span></a>
                                        <a href="#"><span class="fa fa-star-o"></span></a>
                                    </div>
                                    <!-- review form -->
                                    <form action="" class="aa-review-form">
                                        <div class="form-group">
                                            <label for="message">Your Review</label>
                                            <textarea class="form-control" rows="3" id="message"></textarea>
                                        </div>
                                        <div class="form-group">
                                            <label for="name">Name</label>
                                            <input type="text" class="form-control" id="name" placeholder="Name">
                                        </div>
                                        <div class="form-group">
                                            <label for="email">Email</label>
                                            <input type="email" class="form-control" id="email"
                                                   placeholder="example@gmail.com">
                                        </div>

                                        <button type="submit" class="btn btn-default aa-review-submit">Submit</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Related product -->
                    <div class="aa-product-related-item">
                        <h3>Related Products</h3>
                        <ul class="aa-product-catg aa-related-item-slider">
                            <!-- start single product item -->
                            <li>
                                <figure>
                                    <a class="aa-product-img" href="#"><img src="img/man/polo-shirt-2.png"
                                                                            alt="polo shirt img"></a>
                                    <a class="aa-add-card-btn" href="#"><span class="fa fa-shopping-cart"></span>Add To
                                        Cart</a>
                                    <figcaption>
                                        <h4 class="aa-product-title"><a href="#">Polo T-Shirt</a></h4>
                                        <span class="aa-product-price">$45.50</span><span class="aa-product-price"><del>$65.50</del></span>
                                    </figcaption>
                                </figure>
                                <div class="aa-product-hvr-content">
                                    <a href="#" data-toggle="tooltip" data-placement="top" title="Add to Wishlist"><span
                                            class="fa fa-heart-o"></span></a>
                                    <a href="#" data-toggle="tooltip" data-placement="top" title="Compare"><span
                                            class="fa fa-exchange"></span></a>
                                    <a href="#" data-toggle2="tooltip" data-placement="top" title="Quick View"
                                       data-toggle="modal" data-target="#quick-view-modal"><span
                                            class="fa fa-search"></span></a>
                                </div>
                                <!-- product badge -->
                                <span class="aa-badge aa-sale" href="#">SALE!</span>
                            </li>
                            {% for product in related %}
                                {% include "products/_single_product.html" with product=product price="True" %}
                            {% endfor %}
                        </ul>
                        <!-- quick view modal -->
                        {% include "products/_quick_view_modal.html" %}
                        <!-- / quick view modal -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- / product category -->

{% endblock %}
